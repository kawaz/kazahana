# 64bit IDé›£èª­åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ èª¿æŸ»

èª¿æŸ»æ—¥: 2026-02-02
é–¢é€£ãƒãƒ£ãƒƒãƒˆ:
- ã€ŒPCGç–‘ä¼¼ä¹±æ•°ç”Ÿæˆå™¨ã®èª¬æ˜ã€(2026-02-02)
- ã€Œ64ãƒ“ãƒƒãƒˆIDã®é›£èª­åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€(2026-02-01)
- ã€ŒUUIDã¨ã‚·ãƒªã‚¢ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•è§£æ±ºç­–ã€(2026-02-01)

## èª¿æŸ»ç›®çš„

Snowflakeå½¢å¼ã®64bitå†…éƒ¨IDã‚’å¤–éƒ¨å…¬é–‹ç”¨ã«é›£èª­åŒ–ã™ã‚‹å…¨å°„ï¼ˆbijectiveï¼‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®é¸å®šã€‚

### è¦ä»¶

1. **å…¨å°„ï¼ˆå¯é€†ï¼‰**: å†…éƒ¨ID â†” å¤–éƒ¨ID ã®ç›¸äº’å¤‰æ›ãŒå¯èƒ½
2. **æ‹¡æ•£æ€§**: é€£ç•ªå…¥åŠ›ã§ã‚‚å‡ºåŠ›ãŒãƒ©ãƒ³ãƒ€ãƒ ã«è¦‹ãˆã‚‹
3. **é«˜é€Ÿ**: IDç”Ÿæˆã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«ãªã‚‰ãªã„
4. **å®Ÿè£…å®¹æ˜“**: ä¾å­˜ãªã—ã§å„è¨€èªã«ç§»æ¤å¯èƒ½
5. **64bitç¶­æŒ**: å…¥å‡ºåŠ›ã¨ã‚‚ã«64bit

---

## èª¿æŸ»å¯¾è±¡ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### éæš—å·ç³»ï¼ˆéµãªã—ï¼‰

#### 1. ç®—è¡“ç³»ï¼ˆå˜ä½“ã§ã¯ä¸ååˆ†ï¼‰

| åå‰ | æ§‹é€  | æ‹¡æ•£æ€§ | å‚™è€ƒ |
|------|------|--------|------|
| XORå®šæ•° | `x ^ K` | Ã— | æœ€é€Ÿã€æ‹¡æ•£æ€§ãªã— |
| å¥‡æ•°ä¹—ç®— | `x * K` (Kå¥‡æ•°) | â–³ | ç·šå½¢æ€§ã‚ã‚Š |
| åŠ ç®— | `x + K` | Ã— | æ‹¡æ•£æ€§ãªã— |
| ãƒ“ãƒƒãƒˆå›è»¢ | `rotl(x, n)` | Ã— | æ§‹é€ ä¿å­˜ |

ã“ã‚Œã‚‰ã¯çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ã€‚å˜ä½“ã§ã¯é›£èª­åŒ–ã«ä¸ååˆ†ã€‚

#### 2. PRNGãƒŸã‚­ã‚·ãƒ³ã‚°é–¢æ•°

| åå‰ | ç”±æ¥ | ç™ºè¡¨å¹´ | æ‹¡æ•£æ€§ | é€†é–¢æ•° |
|------|------|--------|--------|--------|
| **SplitMix64** | Java SplittableRandom | 2014 | â— | ã‚ã‚Š |
| **moremur** | Pelle Evensen | 2020 | â—â— | ã‚ã‚Š |
| MurmurHash3 finalizer | MurmurHash3 | 2012 | â— | ã‚ã‚Š |
| xxHash finalizer | xxHash | 2014 | â— | ã‚ã‚Š |
| wyhash finalizer | wyhash | 2019 | â—â— | ã‚ã‚Š |
| Stafford Mix13 | æ”¹è‰¯ç‰ˆSplitMix | 2011 | â— | ã‚ã‚Š |
| degski | SplitMixæ”¹è‰¯ | 2018 | â— | ã‚ã‚Š |
| rrxmrrxmsx_0 | Pelle Evensen | 2018 | â— | ã‚ã‚Š |
| nasam | Pelle Evensen | 2020 | â—â— | ã‚ã‚Š |

#### 3. PRNGæœ¬ä½“ï¼ˆçŠ¶æ…‹é·ç§»é–¢æ•°ï¼‰

| åå‰ | æ§‹é€  | ç‰¹å¾´ |
|------|------|------|
| xorshift64 | XOR + ã‚·ãƒ•ãƒˆ | å¤å…¸ã€é«˜é€Ÿ |
| LCG (ç·šå½¢åˆåŒæ³•) | ä¹—ç®— + åŠ ç®— | å…¨å°„ã ãŒäºˆæ¸¬ã—ã‚„ã™ã„ |
| PCG | LCG + å‡ºåŠ›å¤‰æ› | é«˜å“è³ª |
| SFC64 | ã‚«ã‚¦ãƒ³ã‚¿ + å›è»¢ | PractRandåˆæ ¼ |
| romu | å›è»¢ + ä¹—ç®— | 2020å¹´ã€é«˜é€Ÿ |
| wyrand | wyhashç”±æ¥ | è¶…é«˜é€Ÿï¼ˆ128bitä¹—ç®—å¿…è¦ï¼‰ |

### æš—å·ç³»ï¼ˆéµã‚ã‚Šï¼‰

#### 1. å¤å…¸çš„64bitãƒ–ãƒ­ãƒƒã‚¯æš—å·

| åå‰ | æ§‹é€  | ãƒ©ã‚¦ãƒ³ãƒ‰ | ç‰¹å¾´ |
|------|------|---------|------|
| **XTEA** | Feistel | 32 (æ¨å¥¨64) | ã‚·ãƒ³ãƒ—ãƒ«ã€ARXã€å®Ÿç¸¾ã‚ã‚Š |
| TEA | Feistel | 32 | XTEAã®å‰èº«ã€è„†å¼±æ€§ã‚ã‚Š |
| Blowfish | Feistel | 16 | Sãƒœãƒƒã‚¯ã‚¹ã€éµã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—é‡ã„ |
| CAST-128 | Feistel | 12/16 | Sãƒœãƒƒã‚¯ã‚¹4å€‹ |
| GOST 28147-89 | Feistel | 32 | ãƒ­ã‚·ã‚¢æ¨™æº– |
| DES | Feistel | 16 | 56bitéµã€éæ¨å¥¨ |
| 3DES | FeistelÃ—3 | 48 | DES 3å›ã€é…ã„ |
| Skipjack | éFeistel | 32 | NSAã€80bitéµ |
| RC5-64 | ARX | 12-20 | å¯å¤‰ãƒ©ã‚¦ãƒ³ãƒ‰ã€ç‰¹è¨±åˆ‡ã‚Œ |

#### 2. è»½é‡æš—å·ï¼ˆIoTå‘ã‘ï¼‰

| åå‰ | æ§‹é€  | ãƒ©ã‚¦ãƒ³ãƒ‰ | ç‰¹å¾´ |
|------|------|---------|------|
| SIMON-64 | Feistel | 42-44 | NSAã€AND/XOR/å›è»¢ |
| SPECK-64 | ARX | 26-27 | NSAã€é«˜é€Ÿ |
| PRESENT | SPN | 31 | è¶…è»½é‡ã€4bit Sãƒœãƒƒã‚¯ã‚¹ |
| GIFT-64 | SPN | 28 | PRESENTã®æ”¹è‰¯ |
| TWINE | Feistel | 36 | NEC |
| HIGHT | GFN | 32 | éŸ“å›½æ¨™æº–ã€ARX |
| LEA | ARX | 24 | éŸ“å›½æ¨™æº–ã€é«˜é€Ÿ |
| CHAM | ARX | 80 | è»½é‡ã€ã‚·ãƒ³ãƒ—ãƒ« |
| SPARX-64 | ARX | 24 | 2016å¹´ã€è§£æã—ã‚„ã™ã„è¨­è¨ˆ |
| RECTANGLE | SPN | 25 | ãƒ“ãƒƒãƒˆã‚¹ãƒ©ã‚¤ã‚¹å‘ã‘ |

---

## è©³ç´°æ¤œè¨

### SplitMix64

Java 8 ã® `SplittableRandom` ã§æ¡ç”¨ã•ã‚ŒãŸãƒŸã‚­ã‚·ãƒ³ã‚°é–¢æ•°ã€‚

```typescript
const MASK64 = 0xFFFF_FFFF_FFFF_FFFFn;
const MUL1 = 0xBF58476D1CE4E5B9n;
const MUL2 = 0x94D049BB133111EBn;
const MUL1_INV = 0x64046F0D4046F0D5n;
const MUL2_INV = 0x319642B2D24D8EC3n;

function splitmix64_encode(x: bigint): bigint {
  x = (x ^ (x >> 30n)) * MUL1 & MASK64;
  x = (x ^ (x >> 27n)) * MUL2 & MASK64;
  x = x ^ (x >> 31n);
  return x;
}

function splitmix64_decode(x: bigint): bigint {
  x = x ^ (x >> 31n) ^ (x >> 62n);
  x = x * MUL2_INV & MASK64;
  x = x ^ (x >> 27n) ^ (x >> 54n);
  x = x * MUL1_INV & MASK64;
  x = x ^ (x >> 30n) ^ (x >> 60n);
  return x;
}
```

**ç‰¹å¾´**:
- æ§‹é€ : XORã‚·ãƒ•ãƒˆ(30) â†’ ä¹—ç®— â†’ XORã‚·ãƒ•ãƒˆ(27) â†’ ä¹—ç®— â†’ XORã‚·ãƒ•ãƒˆ(31)
- çŸ¥ååº¦ãŒé«˜ã„ï¼ˆJavaæ¨™æº–ï¼‰
- 0â†’0 ã¨ãªã‚‹æ€§è³ªã‚ã‚Šï¼ˆSnowflake IDã§ã¯å•é¡Œãªã—ï¼‰

**å‚è€ƒ**:
- Guy L. Steele Jr., Doug Lea, Christine H. Flood. "Fast Splittable Pseudorandom Number Generators" (2014)
- http://dx.doi.org/10.1145/2714064.2660195

### moremur

Pelle Evensen ã«ã‚ˆã‚‹ SplitMix64 ã®æ”¹è‰¯ç‰ˆã€‚

```typescript
const MASK64 = 0xFFFF_FFFF_FFFF_FFFFn;
const MUL1 = 0x3C79AC492BA7B653n;
const MUL2 = 0x1C69B3F74AC4AE35n;
const MUL1_INV = 0xCBF29CE484222325n;
const MUL2_INV = 0xD0E31B248A51E425n;

function moremur_encode(x: bigint): bigint {
  x = (x ^ (x >> 27n)) * MUL1 & MASK64;
  x = (x ^ (x >> 33n)) * MUL2 & MASK64;
  x = x ^ (x >> 27n);
  return x;
}

function moremur_decode(x: bigint): bigint {
  x = x ^ (x >> 27n) ^ (x >> 54n);
  x = x * MUL2_INV & MASK64;
  x = x ^ (x >> 33n);
  x = x * MUL1_INV & MASK64;
  x = x ^ (x >> 27n) ^ (x >> 54n);
  return x;
}
```

**ç‰¹å¾´**:
- æ§‹é€ : XORã‚·ãƒ•ãƒˆ(27) â†’ ä¹—ç®— â†’ XORã‚·ãƒ•ãƒˆ(33) â†’ ä¹—ç®— â†’ XORã‚·ãƒ•ãƒˆ(27)
- SplitMix64 ã¨åŒä¸€æ§‹é€ ã€å®šæ•°ã¨ã‚·ãƒ•ãƒˆé‡ãŒç•°ãªã‚‹
- ã‚ˆã‚Šç¶²ç¾…çš„ãªæ¢ç´¢ã«ã‚ˆã‚Šæ‹¡æ•£æ€§ãŒæ”¹å–„

**å‚è€ƒ**:
- https://mostlymangling.blogspot.com/2019/12/stronger-better-morer-moremur-better.html

### wyhash finalizer

128bitä¹—ç®—ã‚’ä½¿ç”¨ã™ã‚‹é«˜é€ŸãƒŸã‚­ã‚·ãƒ³ã‚°é–¢æ•°ã€‚

```typescript
function wymix(a: bigint, b: bigint): bigint {
  const full = a * b;
  const lo = full & MASK64;
  const hi = (full >> 64n) & MASK64;
  return lo ^ hi;
}

function wyhash_mix(x: bigint): bigint {
  return wymix(x ^ 0x2D358DCCAA6C78A5n, x ^ 0x8BB84B93962EACC9n);
}
```

**ç‰¹å¾´**:
- 128bitä¹—ç®—ãŒå¿…è¦
- ãƒã‚¤ãƒ†ã‚£ãƒ–ç’°å¢ƒï¼ˆRust/Go/C++ï¼‰ã§ã¯æœ€é€Ÿ
- JavaScript/WASM ã§ã¯é…ã„ï¼ˆBigIntã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰

### XTEA

Needham & Wheeler ã«ã‚ˆã‚‹64bitãƒ–ãƒ­ãƒƒã‚¯æš—å·ã€‚

```typescript
function xtea_encrypt(v: [number, number], key: number[]): [number, number] {
  let [v0, v1] = v;
  let sum = 0;
  const delta = 0x9E3779B9;

  for (let i = 0; i < 32; i++) {
    v0 += (((v1 << 4) ^ (v1 >>> 5)) + v1) ^ (sum + key[sum & 3]);
    v0 = v0 >>> 0;
    sum = (sum + delta) >>> 0;
    v1 += (((v0 << 4) ^ (v0 >>> 5)) + v0) ^ (sum + key[(sum >>> 11) & 3]);
    v1 = v1 >>> 0;
  }

  return [v0, v1];
}

function xtea_decrypt(v: [number, number], key: number[]): [number, number] {
  let [v0, v1] = v;
  const delta = 0x9E3779B9;
  let sum = (delta * 32) >>> 0;

  for (let i = 0; i < 32; i++) {
    v1 -= (((v0 << 4) ^ (v0 >>> 5)) + v0) ^ (sum + key[(sum >>> 11) & 3]);
    v1 = v1 >>> 0;
    sum = (sum - delta) >>> 0;
    v0 -= (((v1 << 4) ^ (v1 >>> 5)) + v1) ^ (sum + key[sum & 3]);
    v0 = v0 >>> 0;
  }

  return [v0, v1];
}
```

**ç‰¹å¾´**:
- ARXæ§‹é€ ï¼ˆAdd, Rotate, XORï¼‰
- Sãƒœãƒƒã‚¯ã‚¹ä¸è¦ã€å®Ÿè£…ã‚·ãƒ³ãƒ—ãƒ«
- 128bitéµã€64bitãƒ–ãƒ­ãƒƒã‚¯
- 32ãƒ©ã‚¦ãƒ³ãƒ‰ï¼ˆæ¨™æº–ï¼‰ã€64ãƒ©ã‚¦ãƒ³ãƒ‰ï¼ˆæ¨å¥¨ï¼‰

**å‚è€ƒ**:
- David J. Wheeler, Roger M. Needham. "Tea extensions" (1997)
- http://www.cix.co.uk/~klockstone/xtea.pdf

---

## ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æ¯”è¼ƒ

### é€Ÿåº¦ï¼ˆJavaScript / Node.jsï¼‰

| é–¢æ•° | ops/sec (æ¦‚ç®—) | ç›¸å¯¾é€Ÿåº¦ |
|------|---------------|---------|
| SplitMix64 | ã€œ2,500,000 | 1.0x |
| moremur | ã€œ2,400,000 | 0.95x |
| wyhash_mix | ã€œ1,500,000 | 0.6x |
| XTEA 32R | ã€œ200,000 | 0.08x |

**æ³¨**: JavaScriptã§ã¯128bitä¹—ç®—ãŒé…ã„ãŸã‚ã€wyhashã®å„ªä½æ€§ãŒãªã„ã€‚

### æ‹¡æ•£æ€§ï¼ˆAvalancheç‰¹æ€§ï¼‰

1bitå…¥åŠ›å¤‰åŒ–ã«å¯¾ã™ã‚‹å‡ºåŠ›å¤‰åŒ–bitæ•°ï¼ˆç†æƒ³: 32bit = 50%ï¼‰

| é–¢æ•° | å¹³å‡åè»¢bitæ•° | ç†æƒ³ã¨ã®å·® |
|------|--------------|-----------|
| SplitMix64 | 31.8 | 0.6% |
| moremur | 32.0 | 0.0% |
| wyhash_mix | 32.0 | 0.0% |

---

## 128bitä¹—ç®—ã®ç’°å¢ƒåˆ¥å¯¾å¿œçŠ¶æ³

### ãƒã‚¤ãƒ†ã‚£ãƒ–å¯¾å¿œ

| ç’°å¢ƒ | å¯¾å¿œ | æ–¹æ³• |
|------|------|------|
| x86_64 | â— | `MUL` å‘½ä»¤ |
| ARM64 | â— | `UMULH` å‘½ä»¤ |
| C/C++ | â— | `__uint128_t` (GCC/Clang) |
| Rust | â— | `u128` ãƒã‚¤ãƒ†ã‚£ãƒ– |
| Go | â— | `math/bits.Mul64` |

### ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¿…è¦

| ç’°å¢ƒ | å¯¾å¿œ | å‚™è€ƒ |
|------|------|------|
| JavaScript | â–³ | BigIntã§å¯èƒ½ã ãŒé…ã„ |
| Java | â–³ | `Math.multiplyHigh` (Java 9+) |
| WebAssembly | â–³ | 64bitÃ—2ã§åˆ†å‰²è¨ˆç®— |
| 32bitç’°å¢ƒ | Ã— | é‡ã„ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ |

**çµè«–**: åºƒç¯„ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œã‚’è€ƒæ…®ã™ã‚‹ã¨ã€128bitä¹—ç®—ã«ä¾å­˜ã—ãªã„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒæœ›ã¾ã—ã„ã€‚

---

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å­˜åœ¨çŠ¶æ³

### SplitMix64

| è¨€èª | ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | çŠ¶æ³ |
|------|-----------|------|
| Rust | `rand_xoshiro` | âœ… Randå…¬å¼ |
| Go | `github.com/db47h/rand64/splitmix64` | âœ… |
| JavaScript | `@entropy-source/pseudo-random` | â–³ å¤ã„ |
| Java | æ¨™æº– `SplittableRandom` | âœ… |
| Python | ãªã— | â–³ è‡ªå‰å®Ÿè£… |

### moremur

| è¨€èª | ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | çŠ¶æ³ |
|------|-----------|------|
| å…¨è¨€èª | ãªã— | âŒ å°‚ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã— |

### XTEA

| è¨€èª | ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | çŠ¶æ³ |
|------|-----------|------|
| Go | `golang.org/x/crypto/xtea` | âœ… å…¬å¼ |
| Rust | `xtea` | âœ… |
| JavaScript | `xtea` | âœ… |
| Python | `xtea` | âœ… |
| Java | ãªã— | â–³ è‡ªå‰å®Ÿè£… |

---

## NSAè¨­è¨ˆæš—å·ã¸ã®æ‡¸å¿µ

### èƒŒæ™¯

2013å¹´ã‚¹ãƒãƒ¼ãƒ‡ãƒ³äº‹ä»¶ã§ã€NSAãŒæš—å·æ¨™æº–ã«ãƒãƒƒã‚¯ãƒ‰ã‚¢ã‚’ä»•è¾¼ã‚“ã§ã„ãŸã“ã¨ãŒç™ºè¦šï¼ˆDual_EC_DRBGï¼‰ã€‚

### SIMON/SPECK ã¸ã®ç–‘å¿µ

- è¨­è¨ˆæ ¹æ‹ ãŒååˆ†ã«å…¬é–‹ã•ã‚Œã¦ã„ãªã„
- å­¦è¡“è§£æã§ã¯è„†å¼±æ€§ã¯è¦‹ã¤ã‹ã£ã¦ã„ãªã„ï¼ˆ70æœ¬ä»¥ä¸Šã®è«–æ–‡ã§è§£ææ¸ˆã¿ï¼‰

### SPECK ã® ISO æ¨™æº–åŒ–çµŒç·¯

| æ™‚æœŸ | å‡ºæ¥äº‹ |
|------|--------|
| 2013å¹´6æœˆ | NSAãŒSimon/Speckã‚’å…¬é–‹ |
| 2015å¹´ | ISO/IEC 29192-2ï¼ˆè»½é‡æš—å·æ¨™æº–ï¼‰ã¸ã®è¿½åŠ ã‚’ææ¡ˆ |
| 2018å¹´4æœˆ | **ISO/IEC JTC 1/SC 27ã§æ‹’å¦** â€” ãƒ‰ã‚¤ãƒ„ã€ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«ã€æ—¥æœ¬ã®ä»£è¡¨ãŒåå¯¾ã€‚NSAã®ã€Œæ•µå¯¾çš„ã€ãªæ…‹åº¦ãŒæ‰¹åˆ¤ã•ã‚ŒãŸ |
| 2018å¹´8æœˆ | Linux kernelã‹ã‚‰å‰Šé™¤ï¼ˆ4.20ï¼‰ |
| 2018å¹´10æœˆ | **åˆ¥ã®ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆSC 31ï¼‰ã§RFIDæ¨™æº–ã¨ã—ã¦æ‰¿èª** â€” ISO/IEC 29167-22:2018 |

**é‡è¦ãªç‚¹**: ã€Œæš—å·æ¨™æº–ã€ï¼ˆSC 27ï¼‰ã¨ã—ã¦ã¯æ‹’å¦ã•ã‚ŒãŸãŒã€ã€ŒRFID air interfaceæ¨™æº–ã€ï¼ˆSC 31ï¼‰ã®ä¸€éƒ¨ã¨ã—ã¦åˆ¥ãƒ«ãƒ¼ãƒˆã§æ¡ç”¨ã•ã‚ŒãŸã€‚åŒã˜ISOã§ã‚‚ç•°ãªã‚‹å§”å“¡ä¼šã§ã®æ±ºå®šã§ã‚ã‚Šã€ã€ŒISOæ¨™æº–ã«ãªã£ãŸã€ã¨ã„ã†è¡¨ç¾ã¯æ­£ç¢ºã§ã¯ãªã„ã€‚

### çµè«–

æŠ€è¡“çš„ã«ã¯å•é¡Œãªã„ï¼ˆfull-roundæ”»æ’ƒã¯ç™ºè¦‹ã•ã‚Œã¦ã„ãªã„ï¼‰ãŒã€å¿ƒç†çš„æŠµæŠ—ãŒã‚ã‚‹å±¤ã‚‚å­˜åœ¨ã™ã‚‹ã€‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ã¯ä¸¡æ–¹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æä¾›ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é¸æŠã•ã›ã‚‹ã®ãŒç¾å®Ÿçš„ã€‚

---

## Ascon ã®èª¿æŸ»ï¼ˆNISTè»½é‡æš—å·æ¨™æº– 2023ï¼‰

### æ¦‚è¦

Asconã¯2023å¹´ã«NISTãŒè»½é‡æš—å·æ¨™æº–ã¨ã—ã¦æ¡ç”¨ã—ãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€‚Grazå·¥ç§‘å¤§å­¦ã®ãƒãƒ¼ãƒ ãŒè¨­è¨ˆã€‚

### æ§‹é€ 

- **320bit permutation**ï¼ˆ5Ã—64bitï¼‰ãƒ™ãƒ¼ã‚¹ã® sponge/duplex æ§‹é€ 
- ä¸»ç”¨é€”: AEADï¼ˆèªè¨¼ä»˜ãæš—å·ï¼‰ã€ãƒãƒƒã‚·ãƒ¥
- **64bitãƒ–ãƒ­ãƒƒã‚¯æš—å·ã§ã¯ãªã„**

### 64bitå…¨å˜å°„ã¸ã®é©ç”¨å¯èƒ½æ€§

| æ–¹å¼ | å®Ÿç¾å¯èƒ½æ€§ | å•é¡Œç‚¹ |
|------|-----------|--------|
| Ascon permutationã‚’Feistelã®ãƒ©ã‚¦ãƒ³ãƒ‰é–¢æ•°ã« | ç†è«–ä¸Šå¯èƒ½ | éå‰°è¨­è¨ˆã€é…ã„ |
| Ascon-PRFã®å‡ºåŠ›ã‚’64bitã«åˆ‡ã‚Šè©°ã‚ | å¯èƒ½ | **å…¨å˜å°„ã§ã¯ãªããªã‚‹** |
| ç›´æ¥ä½¿ç”¨ | ä¸å¯èƒ½ | 320bitçŠ¶æ…‹ã€64bitãƒ–ãƒ­ãƒƒã‚¯æš—å·ã§ã¯ãªã„ |

### æ€§èƒ½æ¯”è¼ƒ

| é …ç›® | Ascon | Speck64/128 |
|------|-------|-------------|
| è¨­è¨ˆ | 320bit sponge/duplex | 64bitãƒ–ãƒ­ãƒƒã‚¯æš—å· |
| ä¸»ç”¨é€” | AEADã€ãƒãƒƒã‚·ãƒ¥ | å˜ç‹¬æš—å·åŒ– |
| 64bitå˜ç™ºæš—å· | âŒ ç›´æ¥ä¸å¯ | âœ… å¯èƒ½ |
| æ€§èƒ½ï¼ˆé•·ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ | ~8-11 cycles/byte | ~2.5 cycles/byte |
| NISTæ¨™æº– | 2023å¹´è»½é‡æš—å·æ¨™æº– | ãªã— |

### çµè«–

**Asconã¯64bit ID obfuscationã«ã¯ä¸é©**ã€‚AEAD/ãƒãƒƒã‚·ãƒ¥ç”¨é€”ã«æœ€é©åŒ–ã•ã‚ŒãŸè¨­è¨ˆã§ã‚ã‚Šã€64bitå…¨å˜å°„å¤‰æ›ã¨ã„ã†è¦ä»¶ã‚’æº€ãŸã›ãªã„ã€‚

---

## æ§‹é€ ã®æ¯”è¼ƒ

### SplitMix64 vs moremur

```
SplitMix64: (xor-shift 30) â†’ mul â†’ (xor-shift 27) â†’ mul â†’ (xor-shift 31)
moremur:    (xor-shift 27) â†’ mul â†’ (xor-shift 33) â†’ mul â†’ (xor-shift 27)
```

æœ¬è³ªçš„ã«ã¯åŒã˜æ§‹é€ ã€‚å®šæ•°ã¨ã‚·ãƒ•ãƒˆé‡ã®é¸ã³æ–¹ãŒç•°ãªã‚‹ã€‚moremur ã¯2020å¹´ã®ç ”ç©¶ã§ã‚ˆã‚Šç¶²ç¾…çš„ã«æ¢ç´¢ã—ã¦æœ€é©ãªçµ„ã¿åˆã‚ã›ã‚’ç™ºè¦‹ã€‚

### æŠ½è±¡åŒ–

```typescript
function mix64(x: bigint, shifts: number[], muls: bigint[]): bigint {
  x = (x ^ (x >> BigInt(shifts[0]))) * muls[0] & MASK64;
  x = (x ^ (x >> BigInt(shifts[1]))) * muls[1] & MASK64;
  x = x ^ (x >> BigInt(shifts[2]));
  return x;
}
```

---

## é¸å®šçµæœ

### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼ˆéµãªã—ï¼‰

**æ¡ç”¨: moremur**

ç†ç”±:
- SplitMix64 ã¨åŒç­‰ã®é€Ÿåº¦
- ã‚ˆã‚Šè‰¯ã„æ‹¡æ•£æ€§ï¼ˆ2020å¹´ã®ç ”ç©¶æˆæœï¼‰
- å®Ÿè£…ãŒç°¡å˜ï¼ˆ20è¡Œç¨‹åº¦ï¼‰
- ç‰¹è¨±ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å•é¡Œãªã—
- 128bitä¹—ç®—ä¸è¦

### æš—å·åŒ–ãƒ¢ãƒ¼ãƒ‰ï¼ˆéµã‚ã‚Šï¼‰

**æ¡ç”¨: Speck64ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰+ XTEAï¼ˆNSAæ‡¸å¿µå‘ã‘ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰**

ä¸¡æ–¹ã‚’å®Ÿè£…ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠå¯èƒ½ã¨ã™ã‚‹ã€‚

#### Speck64/128 â€” ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ

| é …ç›® | å†…å®¹ |
|------|------|
| è¨­è¨ˆè€… | NSA |
| å…¬é–‹å¹´ | 2013å¹´ |
| æ§‹é€  | 64bit ARX |
| ãƒ©ã‚¦ãƒ³ãƒ‰ | 27 |
| é€Ÿåº¦ | ~2.5 cycles/byteï¼ˆ~150M ops/secï¼‰ |
| ä¿¡é ¼æ€§ | æŠ€è¡“çš„ã«ã¯å®‰å…¨ã€70æœ¬ä»¥ä¸Šã®è«–æ–‡ã§è§£ææ¸ˆã¿ |

æ¡ç”¨ç†ç”±:
- é«˜é€Ÿï¼ˆXTEAã®ç´„10å€ï¼‰
- æŠ€è¡“çš„ã«ã¯å®‰å…¨ï¼ˆfull-roundæ”»æ’ƒãªã—ï¼‰
- å®Ÿè£…ãŒã‚·ãƒ³ãƒ—ãƒ«ï¼ˆç´„15è¡Œï¼‰

#### XTEAï¼ˆ64ãƒ©ã‚¦ãƒ³ãƒ‰ï¼‰â€” NSAæ‡¸å¿µå‘ã‘ã‚ªãƒ—ã‚·ãƒ§ãƒ³

| é …ç›® | å†…å®¹ |
|------|------|
| è¨­è¨ˆè€… | Wheeler & Needhamï¼ˆã‚±ãƒ³ãƒ–ãƒªãƒƒã‚¸å¤§å­¦ï¼‰ |
| å…¬é–‹å¹´ | 1997å¹´ |
| æ§‹é€  | 64bit Feistel + ARX |
| æ¨å¥¨ãƒ©ã‚¦ãƒ³ãƒ‰ | 64 |
| é€Ÿåº¦ | ~67 cycles/byteï¼ˆ~15M ops/secï¼‰ |
| ä¿¡é ¼æ€§ | âœ… å­¦è¡“ç”±æ¥ã€ç´„30å¹´ã®å®Ÿç¸¾ |

æ¡ç”¨ç†ç”±:
- å­¦è¡“æ©Ÿé–¢ç”±æ¥ã§æ”¿æ²»çš„ã«ä¸­ç«‹ï¼ˆNSAã¨ã¯ç„¡é–¢ä¿‚ï¼‰
- full-roundæ”»æ’ƒã¯ç™ºè¦‹ã•ã‚Œã¦ã„ãªã„
- ã€Œãªãœã“ã®æš—å·ï¼Ÿã€ã¸ã®èª¬æ˜ãŒå®¹æ˜“
- NSAè¨­è¨ˆã‚’é¿ã‘ãŸã„ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘

#### æ€§èƒ½æ¯”è¼ƒ

| å‡¦ç†é‡ | Speck64/128 | XTEA (64R) |
|--------|-------------|------------|
| 1ç§’ã‚ãŸã‚Šå‡¦ç†æ•° | ~150M ops/sec | ~15M ops/sec |
| 100ä¸‡IDå‡¦ç†æ™‚é–“ | ~7ms | ~67ms |

XTEAã§ã‚‚100ä¸‡ID/ç§’ã§67msã€‚å¤§é‡ãƒãƒƒãƒå‡¦ç†ã§ãªã‘ã‚Œã°ååˆ†ã€‚

#### æ¨å¥¨ãƒ—ãƒªã‚»ãƒƒãƒˆ

```typescript
type EncryptionAlgorithm = 'speck64' | 'xtea';

const defaults = {
  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆé«˜é€Ÿï¼‰
  standard: 'speck64',

  // NSAæ‡¸å¿µãŒã‚ã‚‹å ´åˆ
  nsa_free: 'xtea',
} as const;
```

---

---

## PCGï¼ˆPermuted Congruential Generatorï¼‰ã®èª¿æŸ»

### æ¦‚è¦

PCGã¯2014å¹´ã«M.E. O'Neillã«ã‚ˆã£ã¦ç™ºè¡¨ã•ã‚ŒãŸå„ªã‚ŒãŸç–‘ä¼¼ä¹±æ•°ç”Ÿæˆå™¨ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã€‚
å‚è€ƒ: https://www.pcg-random.org

### PCGã®ç‰¹å¾´

| é …ç›® | è©•ä¾¡ |
|------|------|
| çµ±è¨ˆçš„å“è³ª | å„ªç§€ï¼ˆçµ±è¨ˆãƒ†ã‚¹ãƒˆã‚’ã‚ˆãé€šéï¼‰ |
| äºˆæ¸¬å›°é›£æ€§ | é«˜ã„ï¼ˆå¤šãã®RNGã‚ˆã‚Šå®‰å…¨ï¼‰ |
| é€Ÿåº¦ | éå¸¸ã«é«˜é€Ÿ |
| ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ | éå¸¸ã«ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ |
| ã‚³ãƒ¼ãƒ‰ã‚µã‚¤ã‚º | éå¸¸ã«å°ã•ã„ |
| è¤‡æ•°ã‚¹ãƒˆãƒªãƒ¼ãƒ  | å¯¾å¿œï¼ˆä¾‹: 2^63å€‹ï¼‰ |

### PCGã®ä»•çµ„ã¿

ä¹±æ•°ç”Ÿæˆå™¨ã¯2ã¤ã®éƒ¨åˆ†ã«åˆ†ã‘ã‚‰ã‚Œã‚‹ï¼š

1. **çŠ¶æ…‹é·ç§»é–¢æ•°**: å†…éƒ¨çŠ¶æ…‹ã‚’æ¬¡ã®çŠ¶æ…‹ã«æ›´æ–°ã™ã‚‹
2. **å‡ºåŠ›é–¢æ•°**: å†…éƒ¨çŠ¶æ…‹ã‹ã‚‰å®Ÿéš›ã®ä¹±æ•°ã‚’ç”Ÿæˆã™ã‚‹

**å¾“æ¥ã®RNGã®å•é¡Œç‚¹**ï¼š
- å¤šãã¯å‡ºåŠ›é–¢æ•°ãŒå˜ç´”ã™ãã‚‹ï¼ˆçŠ¶æ…‹ã‚’ãã®ã¾ã¾è¿”ã™ãªã©ï¼‰â†’ äºˆæ¸¬ã•ã‚Œã‚„ã™ã„
- æš—å·å­¦çš„RNGï¼ˆFortunaãªã©ï¼‰ã¯å‡ºåŠ›é–¢æ•°ãŒé‡ã™ãã¦é…ã„

**PCGã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**ï¼š
- **çŠ¶æ…‹é·ç§»**: LCGï¼ˆç·šå½¢åˆåŒæ³•ï¼‰ã‚’ä½¿ç”¨ â†’ ã‚·ãƒ³ãƒ—ãƒ«ã§é«˜é€Ÿ
- **å‡ºåŠ›é–¢æ•°**: **Permutationï¼ˆç½®æ›ï¼‰é–¢æ•°**ã‚’é©ç”¨ â†’ çŠ¶æ…‹ã‹ã‚‰äºˆæ¸¬å›°é›£ãªå‡ºåŠ›ã‚’ç”Ÿæˆ

### PCGã¨å˜ä¸€å€¤ãƒŸã‚­ã‚·ãƒ³ã‚°ã®é–¢ä¿‚

PCGãã®ã‚‚ã®ã¯ä¹±æ•°åˆ—ã®ç”Ÿæˆå‘ã‘ã§ã‚ã‚Šã€å˜ä¸€64bitå€¤ã®å¯é€†ãƒŸã‚­ã‚·ãƒ³ã‚°ã«ã¯å‘ã„ã¦ã„ãªã„ã€‚
ç†ç”±ï¼šPCGã®ä»£è¡¨çš„ãªå‡ºåŠ›é–¢æ•°ã¯ãƒ“ãƒƒãƒˆæ•°ã‚’å‰Šæ¸›ã™ã‚‹ï¼ˆä¾‹: 128bitçŠ¶æ…‹ â†’ 64bitå‡ºåŠ›ï¼‰ãŸã‚ä¸å¯é€†ã€‚

ãŸã ã—ã€PCGã®è¨­è¨ˆæ€æƒ³ï¼ˆLCG + å‡ºåŠ›å¤‰æ›ï¼‰ã¯ã€SplitMix64ãªã©ã®ãƒŸã‚­ã‚·ãƒ³ã‚°é–¢æ•°ã®è¨­è¨ˆã«å½±éŸ¿ã‚’ä¸ãˆã¦ã„ã‚‹ã€‚

---

## å“è³ªãƒ†ã‚¹ãƒˆçµæœï¼ˆå®Ÿæ¸¬ï¼‰

Cã«ã‚ˆã‚‹å®Ÿæ¸¬ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœã€‚ã‚µãƒ³ãƒ—ãƒ«æ•°: 100,000

### 1. Avalanche Testï¼ˆå¹³å‡ãƒã‚¤ã‚¢ã‚¹ï¼‰

1bitå…¥åŠ›å¤‰åŒ–ã«å¯¾ã™ã‚‹å‡ºåŠ›å¤‰åŒ–ã®åã‚Šï¼ˆä½ã„ã»ã©è‰¯ã„ï¼‰

| Mixer | ã‚¹ã‚³ã‚¢ | é †ä½ |
|-------|--------|------|
| moremur | 0.002492 | ğŸ¥‡ |
| rrmxmx | 0.002494 | ğŸ¥ˆ |
| nasam | 0.002502 | ğŸ¥‰ |
| SplitMix64 | 0.002517 | 4 |
| MurmurHash3 | 0.002541 | 5 |

### 2. SACï¼ˆStrict Avalanche Criterionï¼‰

å„å…¥åŠ›ãƒ“ãƒƒãƒˆå¤‰åŒ–ãŒå‡ºåŠ›ãƒ“ãƒƒãƒˆã«ä¸ãˆã‚‹å½±éŸ¿ã®å‡ä¸€æ€§

| Mixer | Worst | Avg | ç·åˆ |
|-------|-------|-----|------|
| nasam | **0.0111** | 0.00251 | ğŸ¥‡ |
| SplitMix64 | 0.0115 | 0.00257 | ğŸ¥ˆ |
| MurmurHash3 | 0.0118 | 0.00258 | 4 |
| rrmxmx | 0.0121 | 0.00253 | ğŸ¥‰ |
| moremur | 0.0128 | **0.00250** | 5 |

### 3. BICï¼ˆBit Independence Criterionï¼‰

å‡ºåŠ›ãƒ“ãƒƒãƒˆé–“ã®ç›¸é–¢ï¼ˆä½ã„ã»ã©è‰¯ã„ï¼‰

| Mixer | ã‚¹ã‚³ã‚¢ | é †ä½ |
|-------|--------|------|
| nasam | 0.00199 | ğŸ¥‡ |
| rrmxmx | 0.00200 | ğŸ¥ˆ |
| moremur | 0.00200 | ğŸ¥‰ |
| SplitMix64 | 0.00208 | 4 |
| MurmurHash3 | 0.00215 | 5 |

### ç·åˆè©•ä¾¡

| Mixer | é€Ÿåº¦ | å“è³ª | ãƒãƒ©ãƒ³ã‚¹ |
|-------|------|------|----------|
| MurmurHash3 | â­â­â­ | â­â­ | é€Ÿåº¦é‡è¦–ãªã‚‰ |
| SplitMix64 | â­â­â­ | â­â­ | å®šç•ª |
| **moremur** | â­â­â­ | â­â­â­ | **ãƒ™ã‚¹ãƒˆãƒãƒ©ãƒ³ã‚¹** |
| rrmxmx | â­â­ | â­â­â­ | ä¸­é–“ |
| nasam | â­â­ | â­â­â­ | å“è³ªæœ€å„ªå…ˆãªã‚‰ |

**çµè«–**: moremurã¯é€Ÿåº¦ãŒMurmurHash3ä¸¦ã¿ã§ã€å“è³ªã¯è‹¥å¹²ä¸Šã€‚nasamã¯å“è³ªãƒˆãƒƒãƒ—ã ãŒç´„24%é…ã„ã€‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç”¨é€”ã«ã¯moremurãŒãƒ™ã‚¹ãƒˆãƒãƒ©ãƒ³ã‚¹ã€‚

---

## è¿½åŠ æ¤œè¨ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### rrmxmx

Pelle Evensen ã«ã‚ˆã‚‹åˆ¥ã®ãƒŸã‚­ã‚·ãƒ³ã‚°é–¢æ•°ã€‚

```typescript
function rrmxmx(x: bigint): bigint {
  x = x ^ ror64(x, 49n) ^ ror64(x, 24n);
  x = x * 0x9FB21C651E98DF25n & MASK64;
  x = x ^ (x >> 28n);
  x = x * 0x9FB21C651E98DF25n & MASK64;
  return x ^ (x >> 28n);
}
```

ç‰¹å¾´: å›è»¢ã‚’å¤šç”¨ã€moremurã‚ˆã‚Šè‹¥å¹²é…ã„ãŒå“è³ªã¯åŒç­‰

### nasam

Pelle Evensen ã«ã‚ˆã‚‹é«˜å“è³ªãƒŸã‚­ã‚·ãƒ³ã‚°é–¢æ•°ã€‚

```typescript
function nasam(x: bigint): bigint {
  x = x ^ ror64(x, 25n) ^ ror64(x, 47n);
  x = x * 0x9E6C63D0676A9A99n & MASK64;
  x = x ^ (x >> 23n) ^ (x >> 51n);
  x = x * 0x9E6D62D06F6A9A9Bn & MASK64;
  x = x ^ (x >> 23n) ^ (x >> 51n);
  return x;
}
```

ç‰¹å¾´: å“è³ªæœ€å„ªå…ˆã€ç´„24%ä½é€Ÿ

---

## æœ€çµ‚æ¯”è¼ƒè¡¨

| ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  | ç¨®åˆ¥ | é€Ÿåº¦ (ns/op) | è¨­è¨ˆè€… | ä¿¡é ¼æ€§ | æ¨å¥¨ç”¨é€” |
|-------------|------|-------------|--------|--------|---------|
| moremur | Mixing | ~3.8 | Pelle Evensen | âœ… | **Mixingãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ** |
| SplitMix64 | Mixing | ~3.8 | Steele/Lea | âœ… Javaæ¨™æº– | ä»£æ›¿Mixing |
| Speck64 | æš—å· | ~7 | NSA | âœ… æŠ€è¡“çš„ã«å®‰å…¨ | **æš—å·åŒ–ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ** |
| XTEA | æš—å· | ~67 | Cambridge | âœ… ç´„30å¹´ã®å®Ÿç¸¾ | NSAæ‡¸å¿µå‘ã‘ |
| Ascon | AEAD | N/A | Grazå¤§å­¦ | âœ… NISTæ¨™æº– | **64bitä¸é©** |

---

## å‚è€ƒæ–‡çŒ®

### PCG
- Melissa E. O'Neill. "PCG: A Family of Simple Fast Space-Efficient Statistically Good Algorithms for Random Number Generation" (2014)
- https://www.pcg-random.org

### moremur
- Pelle Evensen. "Stronger, better, morer, moremur; a better mixer" (2020)
- https://mostlymangling.blogspot.com/2019/12/stronger-better-morer-moremur-better.html

### SplitMix64
- Guy L. Steele Jr., Doug Lea, Christine H. Flood. "Fast Splittable Pseudorandom Number Generators" (2014)
- http://dx.doi.org/10.1145/2714064.2660195
- Java 8 SplittableRandom: https://docs.oracle.com/javase/8/docs/api/java/util/SplittableRandom.html

### XTEA
- David J. Wheeler, Roger M. Needham. "Tea extensions" (1997)
- http://www.cix.co.uk/~klockstone/xtea.pdf

### wyhash
- Wang Yi. "wyhash and wyrand" (2019)
- https://github.com/wangyi-fudan/wyhash

### rrmxmx / nasam
- Pelle Evensen. "Better, stronger, mixer, and target the final avalanche" (2020)
- https://mostlymangling.blogspot.com/2020/01/nasam-not-another-strange-acronym-mixer.html

### Speck64
- Ray Beaulieu et al. "The SIMON and SPECK Families of Lightweight Block Ciphers" (2013)
- https://eprint.iacr.org/2013/404.pdf
- ISO/IEC 29167-22:2018ï¼ˆRFIDæ¨™æº–ã¨ã—ã¦ã®æ¡ç”¨ï¼‰

### Ascon
- Christoph Dobraunig et al. "Ascon v1.2" (2021)
- https://ascon.iaik.tugraz.at/
- NIST Lightweight Cryptography Standardization (2023): https://csrc.nist.gov/projects/lightweight-cryptography

### çµ±è¨ˆãƒ†ã‚¹ãƒˆ
- PractRand: http://pracrand.sourceforge.net/
- TestU01 BigCrush: http://simul.iro.umontreal.ca/testu01/tu01.html
